function countingSortInsert(e,t,s,n){if(!(e instanceof Array))throw new TypeError('1st param "arr" must be an array');if(!(t instanceof Array))throw new TypeError('1st param "arrReduced" must be an array');for(let e=n+1;e<t.length;e++){const s=t[e];s&&(s[0]++,s[1]++)}const i=t[n];if(i)i[1]++;else{for(var a=n-1;a>=0;a--){const e=t[a];if(e){const s=e[1]+1;t[n]=[s,s];break}}a<0&&(t[n]=[0,0])}e.splice(t[n][1],0,s)}Vue.component("abbreviation-autocomplete",{data:function(){return{mutableSearchText:this.searchText,focused:!1,loading:!1,recentlySelected:!1,searchList:[],selected:-1}},props:{data:{required:!0,type:Array},debounceWait:Number,limit:{default:1/0,type:Number},minSearchTextLength:{default:1,type:Number},placeholder:String,searchText:{default:"",type:String}},watch:{mutableSearchText:function(){this.onSearchTextChange()}},methods:{isOption:function(e=!0){return this.data.some((t=>e?t.a==this.mutableSearchText:t.a.toLowerCase()===this.mutableSearchText.toLowerCase()))},loadRelatedItems:function(){if(!(this.mutableSearchText.length>=this.minSearchTextLength))return[];{const e=[],t=[];this.data.forEach((s=>{const n=s.d.toLowerCase().indexOf(this.mutableSearchText.toLowerCase());n>=0&&(countingSortInsert(t,e,s,n),s.substrIndex=n)})),this.searchList=t.length<=this.limit?t:t.slice(0,this.limit),this.loading=!1}},onSearchTextChange:function(){this.recentlySelected?this.recentlySelected=!1:(this.focused=!0,this.selected=-1),this.mutableSearchText.length>=this.minSearchTextLength?(this.loading=!0,this.searchList=this.loadRelatedItems()):(this.loading=!1,this.searchList=[])},onUnfocus:function(){this.focused=!1},print:function(e){console.log(e)},select:function(){let e;return-1!==this.selected&&(this.focused=!1,delete this.searchList[this.selected].substrIndex,e=JSON.parse(JSON.stringify(this.searchList[this.selected])),this.mutableSearchText=this.searchList[this.selected].a,this.recentlySelected=!0),e},selectDown:function(){this.selected=(this.selected+1)%this.searchList.length},selectUp:function(){-1===this.selected&&(this.selected=0);const e=this.searchList.length;this.selected=(this.selected+e-1)%e},setSelected(e){this.selected=e}},template:'\n<div class="abbreviation-autocomplete">\n  <input type="text" :placeholder="placeholder" v-model="mutableSearchText" @focus="focused = true" @blur="onUnfocus" @keyup.enter="select" @keydown.down="selectDown" @keydown.up="selectUp">\n  <ul v-show="focused" @mousedown="select">\n    <li v-show="loading">\n      <svg height="10" width="10">\n        <circle cx="5" cy="5" r="3"/>\n      </svg> \n      <svg height="10" width="10">\n        <circle cx="5" cy="5" r="3"/>\n      </svg> \n      <svg height="10" width="10">\n        <circle cx="5" cy="5" r="3"/>\n      </svg> \n    </li>\n    <li v-for="(element, index) in searchList" :class="{ selected: index === selected }" @mouseover="setSelected(index)">\n      <span>{{ element.a }}</span>\n      <span> ({{ element.d.substr(0, element.substrIndex) }}</span><span class="highlight">{{ element.d.substr( element.substrIndex , mutableSearchText.length) }}</span><span>{{ element.d.substr(element.substrIndex + mutableSearchText.length) }})</span>\n    </li>\n  </ul>\n</div>\n',created:function(){this.data.sort(((e,t)=>e.d.localeCompare(t.d))),this.debounceWait&&(this.loadRelatedItems=_.debounce(this.loadRelatedItems,this.debounceWait));const e=this.$listeners;e&&(e["update:search-text"]&&(defaultOnSearchTextChange=this.onSearchTextChange,this.onSearchTextChange=()=>{defaultOnSearchTextChange(),this.$emit("update:search-text",this.mutableSearchText)}),e.select&&(defaultSelect=this.select,this.select=()=>{this.$emit("select",defaultSelect())}))}});
